varlog <- function(x){

### D.vec <-  seq(0.1,15,length=300);
### n <-  10^5;
### 
### v <- 0*D.vec;
### m <- 0*D.vec;
### 
### for (i in 1:length(D.vec)){
###   print(i);
###   D <- D.vec[i];
###   psample <-  rpois(n,D);
###   lnsample <- log(psample + a);
###   v[i] <- var(lnsample);
###   m[i] <- mean(lnsample);  
### }
### 
### v <- c(0,v);
### D.vec <- c(0,D.vec);

v <- c(0,                  0.110045205147111,  0.155674302499040,  
0.199240283140136,  0.242189047882198,  0.274830813611156,  
0.30678253149971,   0.336376960225776,  0.36276580819325,   
0.385654336904667,  0.404089446791022,  0.424333614612062,  
0.437129858162966,  0.452943660446181,  0.466434893326834,  
0.476488197083339,  0.484486487973629,  0.49249522841152,   
0.501087237376189,  0.504282875285597,  0.509923189883806,  
0.512543583522428,  0.516145773969493,  0.517377526505327,  
0.516160210949451,  0.514249381591851,  0.515095766797131,  
0.512427733792008,  0.515117600490143,  0.509917348559294,  
0.507838070157467,  0.505295798702281,  0.504929502636041,  
0.500265191435747,  0.497015315029826,  0.487320048031361,  
0.487777758974984,  0.485618508316968,  0.476952624245141,  
0.475303845688937,  0.474006216097499,  0.461848434437896,  
0.458332447053067,  0.453446492173319,  0.449843396834474,  
0.441924663807357,  0.43838647075641,   0.429512142424767,  
0.428074776646514,  0.422959937779594,  0.417528249217847,  
0.410848959103104,  0.408669676593975,  0.401633566673017,  
0.401134906526841,  0.390649687094264,  0.38747992343559,   
0.382243413467166,  0.378522848674293,  0.374564896691806,  
0.367458951184484,  0.362988549853204,  0.359544379099291,  
0.353591368503773,  0.347167348783288,  0.34532934013547,   
0.343491754076066,  0.334715970021219,  0.328658320850336,  
0.327302967322452,  0.325237744264657,  0.317196459879728,  
0.314765696718547,  0.307332293377655,  0.309124724513742,  
0.301419471275718,  0.299942126585102,  0.294086480682256,  
0.29451286892268,   0.286642099560306,  0.284687076424098,  
0.278509088913386,  0.279246898930461,  0.272296945853559,  
0.275854357665941,  0.266234682115901,  0.264232235767492,  
0.260743675639475,  0.255895230554581,  0.253129574082959,  
0.253298405429449,  0.248730389085991,  0.244982024541409,  
0.243653272630269,  0.242542398779603,  0.240009571527733,  
0.235318245743064,  0.230953677868414,  0.233100068287879,  
0.227364492975657,  0.227413577565514,  0.223276423252749,  
0.220469116366241,  0.217005874041464,  0.218544785776868,  
0.214799027675302,  0.214018994678519,  0.209908302955636,  
0.209051702471355,  0.208269790368667,  0.204259169294716,  
0.203328013924332,  0.20139968939544,   0.196635030214222,  
0.197297827567890,  0.192382446324047,  0.190582509801817,  
0.189428806176448,  0.189018477853706,  0.186473265172133,  
0.185725521054363,  0.183336063547263,  0.179873235505833,  
0.181615456173920,  0.178567664485195,  0.180557785189292,  
0.176737837993348,  0.174040551678814,  0.171824187553651,  
0.171777723418986,  0.168380946262357,  0.167631607118801,  
0.166919135507693,  0.164922649827378,  0.162995673372005,  
0.162041121757856,  0.160429501411519,  0.158707612157130,  
0.158642112150017,  0.157617876132955,  0.155840318142859,  
0.155284818162058,  0.154345535308525,  0.152630388942585,  
0.150400283124370,  0.150179674628796,  0.148869143035009,  
0.147554042030182,  0.147637243060954,  0.146194131788119,  
0.145835948812554,  0.143900378918811,  0.142903437859195,  
0.140917152296187,  0.139117847089593,  0.139003657513961,  
0.137598972361976,  0.136898074042553,  0.137154473844298,  
0.138277493211632,  0.136153278722467,  0.133522299804145,  
0.133384294590176,  0.132111294310897,  0.131449376323826,  
0.129586583208922,  0.129584131533865,  0.128605107720163,  
0.128189826312729,  0.126278134313609,  0.126045116482753,  
0.125363001954594,  0.125224617388382,  0.126668143826167,  
0.123422245086036,  0.122700642899329,  0.120987094238997,  
0.120618983640502,  0.120998211699260,  0.119009954803664,  
0.119072562187199,  0.116957337765395,  0.116680737862498,  
0.117294560721681,  0.116695492579975,  0.114830982812096,  
0.114452052183997,  0.114245211769627,  0.114315514762654,  
0.112282326346754,  0.111852441235201,  0.110154831749858,  
0.110949143154516,  0.111595448779907,  0.110139507919548,  
0.109619808328594,  0.107627781123346,  0.106292421187722,  
0.107528857315614,  0.107070062504316,  0.104962719477169,  
0.105885465593304,  0.105345175432258,  0.104004548692924,  
0.104007877693652,  0.103411120226547,  0.101789057880723,  
0.101536467048211,  0.101502818722149,  0.101222738630674,  
0.100589257283155,  0.100600012398812,  0.0994090515882939, 
0.098141116855587,  0.0983345183753183, 0.0983475058437739, 
0.0978642331067521, 0.0967356239827741, 0.0976418040766334, 
0.0962194080615377, 0.0944875846858419, 0.0952789448608961, 
0.0944033012813256, 0.0937156161305736, 0.0950085227687757, 
0.0938882650397986, 0.0922415298468536, 0.0925269942322057, 
0.0922305335446072, 0.092350127862761,  0.0908886172472816, 
0.0906072445847259, 0.0897827360739802, 0.0907187777163641, 
0.0894486510392851, 0.0893203696074944, 0.0885045853082157, 
0.088157737706543,  0.0888194346308406, 0.0886673668526806, 
0.0872805761693292, 0.0866006855426778, 0.0873018174147107, 
0.0864056772925893, 0.085843020560773,  0.085786798274907,  
0.084957644963066,  0.08442702492386,   0.0838130981202873, 
0.0838018083043259, 0.0844442109155162, 0.0836936371055533, 
0.083441746455094,  0.0824912376277994, 0.0831439339542078, 
0.0826213771814651, 0.0817736620904201, 0.081650093627315,  
0.0814936959202959, 0.0804695057361529, 0.079961385522678,  
0.0805956075603186, 0.0798579970053057, 0.0790915589787416, 
0.0795055152002543, 0.0794399668442776, 0.0787265600649642, 
0.0773199836971551, 0.0782699753415416, 0.0775746639743982, 
0.0771684649725518, 0.0768586185492326, 0.0768449587685232, 
0.0768041986132872, 0.07564320206542,   0.0759214939671308, 
0.075275584293215,  0.0759191546693133, 0.0744105683163762, 
0.0749816614371138, 0.0746608077961628, 0.0741655284219431, 
0.0739561819308535, 0.0734252353479796, 0.0735356772211536, 
0.0727903233661427, 0.0730900291306994, 0.0721686067912985, 
0.071879392007249,  0.0721158795158988, 0.0719603110339099, 
0.0710458334842105, 0.0706505701035134, 0.0714675497242161, 
0.0708831343963561, 0.0704377484045542, 0.0704691611990377, 
0.070369020316722,  0.0700854770164202, 0.0701091716474867, 
0.0696031176289019)

D.vec <- c(0,                 0.1,               0.149832775919732,
0.199665551839465, 0.249498327759197, 0.29933110367893, 
0.349163879598662, 0.398996655518395, 0.448829431438127,
0.49866220735786,  0.548494983277592, 0.598327759197325,
0.648160535117057, 0.697993311036789, 0.747826086956522,
0.797658862876254, 0.847491638795987, 0.89732441471572, 
0.947157190635452, 0.996989966555184, 1.04682274247492, 
1.09665551839465,  1.14648829431438,  1.19632107023411, 
1.24615384615385,  1.29598662207358,  1.34581939799331, 
1.39565217391304,  1.44548494983278,  1.49531772575251, 
1.54515050167224,  1.59498327759197,  1.64481605351171, 
1.69464882943144,  1.74448160535117,  1.79431438127090, 
1.84414715719064,  1.89397993311037,  1.9438127090301,  
1.99364548494983,  2.04347826086957,  2.09331103678930, 
2.14314381270903,  2.19297658862876,  2.24280936454850, 
2.29264214046823,  2.34247491638796,  2.39230769230769, 
2.44214046822743,  2.49197324414716,  2.54180602006689, 
2.59163879598662,  2.64147157190635,  2.69130434782609, 
2.74113712374582,  2.79096989966555,  2.84080267558528, 
2.89063545150502,  2.94046822742475,  2.99030100334448, 
3.04013377926421,  3.08996655518395,  3.13979933110368, 
3.18963210702341,  3.23946488294314,  3.28929765886288, 
3.33913043478261,  3.38896321070234,  3.43879598662207, 
3.48862876254181,  3.53846153846154,  3.58829431438127, 
3.63812709030100,  3.68795986622074,  3.73779264214047, 
3.7876254180602,   3.83745819397993,  3.88729096989967, 
3.9371237458194,   3.98695652173913,  4.03678929765886, 
4.08662207357860,  4.13645484949833,  4.18628762541806, 
4.23612040133779,  4.28595317725753,  4.33578595317726, 
4.38561872909699,  4.43545150501672,  4.48528428093645, 
4.53511705685619,  4.58494983277592,  4.63478260869565, 
4.68461538461538,  4.73444816053512,  4.78428093645485, 
4.83411371237458,  4.88394648829431,  4.93377926421405, 
4.98361204013378,  5.03344481605351,  5.08327759197324, 
5.13311036789298,  5.18294314381271,  5.23277591973244, 
5.28260869565217,  5.33244147157191,  5.38227424749164, 
5.43210702341137,  5.4819397993311,   5.53177257525084, 
5.58160535117057,  5.6314381270903,   5.68127090301003, 
5.73110367892977,  5.7809364548495,   5.83076923076923, 
5.88060200668896,  5.9304347826087,   5.98026755852843, 
6.03010033444816,  6.07993311036789,  6.12976588628763, 
6.17959866220736,  6.22943143812709,  6.27926421404682, 
6.32909698996656,  6.37892976588629,  6.42876254180602, 
6.47859531772575,  6.52842809364549,  6.57826086956522, 
6.62809364548495,  6.67792642140468,  6.72775919732442, 
6.77759197324415,  6.82742474916388,  6.87725752508361, 
6.92709030100334,  6.97692307692308,  7.02675585284281, 
7.07658862876254,  7.12642140468227,  7.17625418060201, 
7.22608695652174,  7.27591973244147,  7.3257525083612,  
7.37558528428094,  7.42541806020067,  7.4752508361204,  
7.52508361204013,  7.57491638795987,  7.6247491638796,  
7.67458193979933,  7.72441471571906,  7.7742474916388,  
7.82408026755853,  7.87391304347826,  7.923745819398,   
7.97357859531773,  8.02341137123746,  8.0732441471572,  
8.12307692307692,  8.17290969899665,  8.22274247491639, 
8.27257525083612,  8.32240802675585,  8.37224080267559, 
8.42207357859532,  8.47190635451505,  8.52173913043478, 
8.57157190635452,  8.62140468227425,  8.67123745819398, 
8.72107023411371,  8.77090301003344,  8.82073578595318, 
8.87056856187291,  8.92040133779264,  8.97023411371237, 
9.0200668896321,   9.06989966555184,  9.11973244147157, 
9.1695652173913,   9.21939799331104,  9.26923076923077, 
9.3190635451505,   9.36889632107023,  9.41872909698997, 
9.4685618729097,   9.51839464882943,  9.56822742474916, 
9.6180602006689,   9.66789297658863,  9.71772575250836, 
9.7675585284281,   9.81739130434783,  9.86722408026756, 
9.9170568561873,   9.96688963210702,  10.0167224080268, 
10.0665551839465,  10.1163879598662,  10.1662207357860, 
10.2160535117057,  10.2658862876254,  10.3157190635452, 
10.3655518394649,  10.4153846153846,  10.4652173913043, 
10.5150501672241,  10.5648829431438,  10.6147157190635, 
10.6645484949833,  10.714381270903,   10.7642140468227, 
10.8140468227425,  10.8638795986622,  10.9137123745819, 
10.9635451505017,  11.0133779264214,  11.0632107023411, 
11.1130434782609,  11.1628762541806,  11.2127090301003, 
11.2625418060201,  11.3123745819398,  11.3622073578595, 
11.4120401337793,  11.461872909699,   11.5117056856187, 
11.5615384615385,  11.6113712374582,  11.6612040133779, 
11.7110367892977,  11.7608695652174,  11.8107023411371, 
11.8605351170569,  11.9103678929766,  11.9602006688963, 
12.0100334448161,  12.0598662207358,  12.1096989966555, 
12.1595317725753,  12.2093645484950,  12.2591973244147, 
12.3090301003344,  12.3588628762542,  12.4086956521739, 
12.4585284280936,  12.5083612040134,  12.5581939799331, 
12.6080267558528,  12.6578595317726,  12.7076923076923, 
12.7575250836120,  12.8073578595318,  12.8571906354515, 
12.9070234113712,  12.9568561872910,  13.0066889632107, 
13.0565217391304,  13.1063545150502,  13.1561872909699, 
13.2060200668896,  13.2558528428094,  13.3056856187291, 
13.3555183946488,  13.4053511705686,  13.4551839464883, 
13.5050167224080,  13.5548494983278,  13.6046822742475, 
13.6545150501672,  13.7043478260870,  13.7541806020067, 
13.8040133779264,  13.8538461538462,  13.9036789297659, 
13.9535117056856,  14.0033444816054,  14.0531772575251, 
14.1030100334448,  14.1528428093646,  14.2026755852843, 
14.2525083612040,  14.3023411371237,  14.3521739130435, 
14.4020066889632,  14.4518394648829,  14.5016722408027, 
14.5515050167224,  14.6013377926421,  14.6511705685619, 
14.7010033444816,  14.7508361204013,  14.8006688963211, 
14.8505016722408,  14.9003344481605,  14.9501672240803, 
15)




if (is.na(x)) return(NA);
if (x > 15) {y <- 1/x
           } else {
             ind <- which.min(abs(x-D.vec));
             y <- v[ind]}
return(y);
}
